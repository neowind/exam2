<!DOCTYPE html>
<html>
<head>
    <title>Hotels</title>
</head>
<body>
    <script src="../../Content/Scripts/handlebars-v4.0.5.js"></script>
    <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-2.0.3.min.js"></script>
    
    <script id="hotels-template" type="text/x-handlebars-template">
        {{#each this}}
        <table>
            <tr>
                <th>
                    {{Name}}
                </th>
                <th>
                    {{Rating}}
                </th>
                <th>
                    {{LowestPrice}}
                </th>
                <th>
                    {{Location}}
                </th>
                <th></th>
            </tr>
        </table>
        {{/each}}
    </script>
   
    <div class="content-placeholder"></div>
    <button id="fetchData">Fetch Hotel Data</button>
    <script src="~/Content/Scripts/ajaxCall.js"></script>
    <script>
        var uri = 'api/ajax';

        // Grab the template script
        var theTemplateScript = $("#hotels-template").html();

        //complie template
        var theTemplate = Handlebars.compile(theTemplateScript);

        var _ajaxCall = new ajaxCall($, theTemplate, $('.content-placeholder'));
        //function onSuccess(template, data) {
        //    var theCompiledHtml = template(data);

        //    //// Add the compiled html to the page
        //    $('.content-placeholder').html(theCompiledHtml);
        //};

        //function onFiled(jqXHR, textStatus) {
        //    $('.content-placeholder').html(textStatus);
        //};

        //function requestData(requester, template) {
        //    requester.getJSON(uri)
        //        .done(onSuccess.bind(undefined, template))
        //        .fail(onFiled);
        //};

        function onFetchHotelDataClick() {
            _ajaxCall.requestData(uri);
        };

    $(document).ready(function () {
        $('#fetchData').click(onFetchHotelDataClick);
    });

    </script>
</body>
</html>
